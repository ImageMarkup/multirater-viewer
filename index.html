<!DOCTYPE html5>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>ISIC MultiRater Viewer</title>

    <!-- Bootstrap -->
    
    <link href="css/jquery-ui.css" rel="stylesheet">
    
    <link href="css/jquery-ui.theme.css" rel="stylesheet">
    <link href="css/bootstrap.css" rel="stylesheet">
    

    <script src="references/jquery-ui-1.11.4/external/jquery/jquery.js"></script>

	<!--     <script src="js/jquery-2.1.3.js"></script> -->
    <script src="js/jquery-ui.js"></script>
	
   <script src="js/bootstrap.js"></script>


    <style>


	.mainimg {
	  width:600px;
	  position:absolute;
	  border:1px solid #666;
	  padding:3px;
	  margin-right:5px;

	}


	.overlay_img {
	  width:600px;

	  position:absolute;

	  display:block;
	  border:1px solid #666;

	  padding:3px;
	  margin-right:5px;

	}
	</style>


  </head>
  <body>
 
	
	<div class="row"> 
		<div class="col-md-4" style="background-color: #dedef8; "> Image Info </div> 
		<div class="col-md-8" style="background-color: #dedef8; ">
			<span id="img_info"></span> 
		</div>
	</div><br> 



		<div class="row">
		
		<div class="col-md-4">
			Image List <select id='image_list_dd'></select> 
			Feature List <input type=checkbox id='feature_list'></input>


		</div>
			<div class="col-md-8"> 
				<span id="tile_toggle">Toggle Tile
					<a id="button" title="button">Tiles Off</a>

				</span>  
				<span id="tile_opacity">Tile Opacity</span>  


				<button id="tile_button">Toggle Tile Overlay</button>


				<span>Structure List: Net Atypical</span>


						<p>Select the raters to overlay:</p>
						<div>
						
						</div>
						<script>
						$("input").button ();
						$("div").buttonset ();
						</script>
			</div>


		</div>

		<div class="row">
		
			<div class="col-md-4"> 
				<div id="slider"> </div>
				<div id="rater_list" style="border:1px">
						<!-- NEED TO ADD THESE DYNAMICALLY WITH A FOREACH FUNCTION -->
						<input type=checkbox name=Ash id=show_Ash><label for=show_ash>Ash</label></input>
						<input type=checkbox name=Rabinowitz id=show_Rabinowitz><label for=show_Rabinowitz>Rabinowitz</label></input>
						<input type=checkbox name=Carrera id=show_Carrera><label for=show_Carrera>Carrera</label></input>
						<input type=checkbox name=Braun id=show_Braun><label for=show_Braun>Braun</label></input>
			

				 </div>
			</div>
			<div class="col-md-8"> <img id="base_img" src='images/base_img/UDA2_pilot_030-p1c.png' class="mainimg"> 
					<img id='tile_img' src='images/base_img/UDA2_pilot_030-tile-p1c.png' class="overlay_img">
					<img id='Carrera_img' src='images/features_output_dir/net_typ/UDA2_pilot_016_Carrera_net_typ.png' class="overlay_img">
					<img id='Ash_img' src='images/features_output_dir/net_atyp/UDA2_pilot_016_Ash_net_atyp.png' class="overlay_img">
					<img id='Braun_img' src='images/features_output_dir/net_typ/UDA2_pilot_016_Braun_net_typ.png' class="overlay_img">
					<img id='Rabinowitz_img' src='images/features_output_dir/net_atyp/UDA2_pilot_016_Rabinowitz_net_atyp.png' class="overlay_img">
			
			<!--  These img tags should be added in runtime based on the rater list['Ash','Braun','Rabinowitz','Carrera'];  -->
					
			</div>

			
		</div>


    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    
    <!-- Include all compiled plugins (below), or include individual files as needed -->
 

    <script>

    //Probably a cleaner way than making these global variables... Discsuss with Brian on refactoring
    var active_image = '';
    var current_feature = "net_typ";
    var feature_overlay_basedir = 'images/features_output_dir/';
    	//$( ".target" ).toggle();
    	//<div id="clickme">
  		//Click here
		//</div>
		//<img id="book" src="book.png" alt="" width="100" height="123">
		//We will cause .toggle() to be called when another element is clicked:

	//$( "#clickme" ).click(function() {
  	//$( "#book" ).toggle( "slow", function() {
    // Animation complete.
	//  });
	//});

     var my_data = {};
  	$(document).ready(function(){
  		console.log('data is loading?')
    	
		var $select = $('#image_list_dd');
 
    //request the JSON data and parse into the select element
    $.getJSON('json_data/img_list.json', function(data){
      //clear the current content of the select
      	$select.html('');
 		my_data = data.responseJSON;
 		console.log('meh?')
      //iterate over the data and append a select option
      	$.each(data, function(key, val){
      		  $select.append('<option id="' + val + '">' + val + '</option>');    });

						      });

    //MANY many things to do
    // add a toggle button so I can turn on/off the tile/overlay
    // add a slider that actually works lnked to the opacity of the slider image
    // long term add the ability to shift the color of the base image
    

  	// Add event handler for changing the image
  	$select.change( function() { 

  					console.log(this.value)
  					//Need to change the image source based on the new image I just added in the toggle, will also push the text
  					// to a DIV so it's obvious what Image I am looking at
  					$selected_image = this.value;
  					full_img_url = 'images/base_img/' + $selected_image + '-p1c.png';
  					console.log(full_img_url);
  					$("#base_img").attr("src",full_img_url);

  					//ALSO ADD IN SOMETHING HERE TO CHANGE THE OVERLAY images
  					update_rater_overlays( $selected_image);

				//	<img id='marchetti_img' src='images/features_output_dir/net_typ/UDA2_pilot_016_Carrera_net_typ.png' class="overlay_img">
				//	<img id='ash_img' src='images/features_output_dir/net_atyp/UDA2_pilot_016_Rabinowitz_net_atyp.png' class="overlay_img">



  					});

	$("#tile_toggle").button ();

//$( "#slider" ).slider({
//	range: true,
//	values: [ 17, 67 ]
//});

	$("#tile_button").button();

	$("#tile_button").click( function() { 
					console.log('clicked it!!');
					 	$('#tile_img').toggle();
				console.log('clicked it i dare say!');
					
						      }  );

    	});



  	$("#idred").button().click( function(event) { console.log(event)}  )


  	$('#tile_img').toggle();

  	function update_rater_overlays ( selected_base_image)
  		{
  			console.log("NEED TO update the overlay SRC ids as well");
  			//This will eventually need to reed the list or raters and update the sources for all of the raters that have been added
  			//ALSO need to add in something that populates the stats for the rater(s)
  			raters = ['Ash','Braun','Rabinowitz','Carrera'];
  			$.each(raters, function(index,value) { 

  					cur_feature = 'net_atyp'
  					rater_overlay_url = feature_overlay_basedir + cur_feature + '/' + selected_base_image+'_' + value + '_' + cur_feature +'.png';
  					console.log(rater_overlay_url);
  					img_id = value+'_img';  // this is the actual ID I used when I created the image tag

  					$("#"+img_id).attr("src",rater_overlay_url); //actually update the rater overlay.. I need to add a check code
  																//that if the overlay doesn't actually exist (e.g. no file written)
  																//just make the img src equal to null

  					$("#"+img_id).show(); // I think I need to reset this flag each time... probably need to combine this with an error handler..
  				console.log(index+value);


  						});

  		}
  			//ADDING A CLASS HANDLER FOR ALL OVERLAYS SO THEY ARE HIDDEN IF IT CAN'T FIND THE IMAGE
		$(".overlay_img").error(function(){
  							$(this).hide();
							});		


    </script>
  


  </body>
</html>