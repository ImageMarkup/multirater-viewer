<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset = UTF-8">
    <title>ISIC</title>
    <link rel="stylesheet" type="text/css" href="bower_components/webix/codebase/webix.css">
    <link rel="stylesheet" type="text/css" href="css/isic.css">
    <script type="text/javascript" src="bower_components/webix/codebase/webix.js"></script>
    <script type="text/javascript" src="bower_components/jquery/dist/jquery.js"></script>
    <script type="text/javascript" src="createFeatureWidgetData.js"></script>
    <script type="text/javascript" src="createFeatureWidget.js"></script>
</head>

<body>
    <!-- <div id="main_layout" style="height:100%"></div> -->
    <div id="main_layout" style="height:100%"></div>
    <!-- <div id="image_viewer" style="width:100%; height:100%"></div>    -->
    <script>
    //I obtained this from https://isic-archive.com/api/v1#!/featureset/find




    function processFeatureSetData(featureSetData) {
        //This processes the feature set data I get from the API
        //and generates a hierarchy that I can use to create a widget
        //for rendering the results
        //Need to parse localFeatures and GlobalFeatures

        FeatureDataForUI = {}
        $.each(featureSetData.localFeatures, function(id, feature) {
            console.log(id, feature)
                //keys I need are id, type, and name... if name is an array then I need to nest it
            featGroup = feature.name[0];

            if (featGroup in FeatureDataForUI) {
                curData = FeatureDataForUI[featGroup];
                curData.push({
                    id: feature.id,
                    FeatGroup: feature.name[0],
                    FullName: feature.name[1]
                })
            } else {
                FeatureDataForUI[featGroup] = [{
                    id: feature.id,
                    FeatGroup: feature.name[0],
                    FullName: feature.name[1]
                }]

            }
        });

        return FeatureDataForUI;
    }



    TopLevelFeatures = ['GlobalFeatures', 'Globs', 'Lines', 'Blobs'];
    TopLevelFeatures = processFeatureSetData(LongFeatureExample);

    FeatureAccordion = {
        view: "accordion",
        id: "FeatureAccordion",
        multi: false,
        rows: //or rows 
            [
            //add these dynamically
        ]
    }

    webix.ready(function() {

        FeatureSetListWidget = {
            view: "combo",
            label: 'Combo',
            value: 0, ///Set the first value?
            options: {
                body: {
                    template: "#name#",
                    data: FeatureSetList
                }
            }
        };

        var layout = webix.ui({
            container: "main_layout",
            id: "layout",
            height: 550,
            width: 400,
            rows: [{
                    cols: [
                        FeatureSetListWidget, {
                            template: "col 2"
                        },

                    ]
                }, FeatureAccordion,

            ]
        });




        form3 = {
            view: "segmented",
            value: "three",
            label: "Select one",
            labelPosition: "top",
            options: [{
                id: "one",
                value: "One"
            }, {
                id: "two",
                value: "Two"
            }, {
                id: "three",
                value: "Three"
            }]
        };


        // http://docs.webix.com/samples/13_form/01_controls/07_segmented.html
        $.each(Object.keys(TopLevelFeatures), function(x, tlf) {
            // console.log(tlf);

            CurButtonSet = form2;

            //Now create a button set for the current set of features


            FeaturesForCurrentGroup = TopLevelFeatures[tlf];

            ButtonOptions = []

            $.each(FeaturesForCurrentGroup, function(x1, glf) {
                //group level features
                //console.log(glf);
                CurButtonCfg = {
                        view: "button",
                        id: "my_" + glf.id,
                        value: glf.id,
                        inputWidth: 100,
                        // height: 50
                    }
                    // 
                    // ButtonOptions.push( { id: glf.id, value: glf.id})
                    // // // 
                ButtonOptions.push(CurButtonCfg)
            })
            console.log(ButtonOptions);

            MyButtons = [ {view:"button", id:'hi',value:'moo2',inputWidth: 0},{view:"button", id:'howdy',value:'moo',inputWidth: 100}]


            // ButtonSetConfig = { view:"segmented", options: ButtonOptions};
            ButtonSetConfig = {
                    view: "form",
                    width: 100,
                    elements: [{
                        cols:  ButtonOptions
                         //End of cols
                    }]
                },

                // ]
                //             {cols:[
                //         { rows: 

                //              ButtonOptions }]};

                // var form2 = {
                //     view:"form", width:100, scroll:false,
                //     elements:[
                //         { view:"button", value:"Standard", height:50 }, 
                //         { view:"button", value:"Form", type:"form", height:50 }, 
                //         { view:"button", value:"Danger", type:"danger", height:50 }, 
                //         { view:"button", label:"Prev", type:"prev", height:50 },
                //         { view:"button", label:"Next", type:"next", height:50 }
                //     ]
                // };

                ItemGroup = {
                    view: "accordionitem",
                    header: tlf,
                    collapsed: true,
                    // headerHeight:30, 
                    body: ButtonSetConfig
                        // {
                        //     view: "form",
                        //     width: 300,
                        //     elements: CurButtonSet
                        // },
                };
            console.log(ButtonSetConfig);
            //Use the badges for a multirater viewer
            // http://docs.webix.com/desktop__button_groups.html
            // http://docs.webix.com/desktop__button.html

            // { view:"button", width:40, badge:12, type:"icon", icon:"envelope" }



            $$('FeatureAccordion').addView(ItemGroup);


        });




    })
    </script>
    <!-- webix.ready(function(){
 
  var app = webix.ui({
    view:"accordion",
    multi:true,
    id: 'accordion',
    cols:[ //or rows 
      { 
        header:"col 1",
        id:'col1'
      },
      { header:"col 2", body:"content 2" },
      { header:"col 3", body:"content 3" }
    ]
  });
 
  var config = { rows:[{
    view:"accordionitem",
    header:"dyn header",
    body:"dyn body"
  }]};
 
  // This works
  //$$('accordion').addView(config);
 
 
  // This does not work
  var view = webix.ui(config);
  $$('accordion').addView(view.getChildViews()[0]);
            // var copiedObject = jQuery.extend({}, originalObject) 
}); -->
    <!-- http://webix.com/snippet/f9dbea6a -->
</body>

</html>
